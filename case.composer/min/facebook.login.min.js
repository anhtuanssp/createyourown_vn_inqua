!function(e,o,t,n){CP.FacebookLoginModule=function(e){this.$el=null,this.parent=e,this.htmlNotAuth='<div id="facebook-login-zone"><span class="btn btn-primary" style="margin: 0px;" onclick="CP.FacebookService.getInstance.loginFacebook()"><i class="fa fa-facebook size-18" style="color:#fff"></i> Đăng nhập với Facebook - CYW</span><hr/></div>',this.htmlAuth='<div id="facebook-login-zone" style="text-align:center;padding:10px;background:#45619D;color:#fafafa;margin-bottom:10px;-webkit-box-shadow: -10px 9px 0px -2px rgba(255,213,0,1);-moz-box-shadow: -10px 9px 0px -2px rgba(255,213,0,1);box-shadow: -10px 9px 0px -2px rgba(255,213,0,1);"><div style="width:70px;overflow:hidden; display: inline-block;"><i class="fa fa-facebook size-32" style="color:#fff;position: absolute;"></i><a href="profile.html" style="color:#fff"><img class="img-profile" src="" style="width:100%"/></a></div><br/>Chào :<b><a href="profile.html" style="color:#fff"><span class="username"> </span></a></b><br/><span class="btn btn-primary bnt-logout"> Log out </span></div>'},CP.FacebookLoginModule.prototype.init=function(e){if("undefined"!=typeof FB)this.renderLayout(e);else var t=this,n=setInterval(function(){"undefined"!=typeof FB&&(FB.Event.subscribe("auth.statusChange",t.auth_status_change_callback.bind(t)),t.renderLayout(e),o.clearInterval(n))},1e3)},CP.FacebookLoginModule.prototype.renderLayout=function(e){CP.FacebookService.getInstance.checkLogin(this.renderLayoutAuth.bind(this,e),this.renderLayoutNotAuth.bind(this,e),this.renderLayoutNotAuth.bind(this,e))},CP.FacebookLoginModule.prototype.logout=function(){FB.logout(function(e){})},CP.FacebookLoginModule.prototype.renderLayoutNotAuth=function(o){this.$el=e(this.htmlNotAuth),o()},CP.FacebookLoginModule.prototype.renderLayoutAuth=function(o){this.$el=e(this.htmlAuth);var t=this;CP.FacebookService.getInstance.getInfo(function(e){t.$el.find(".username").html(e.name)}),FB.api("/me/picture?type=large",function(e){t.$el.find(".img-profile").attr("src",e.data.url)}),this.$el.find(".bnt-logout").click(function(e){t.logout()}),o()},CP.FacebookLoginModule.prototype.auth_status_change_callback=function(e){var o=this;null!=e.authResponse?(CP.FacebookService.getInstance.getInfo(function(o){CP.FacebookService.getInstance.getProfilePic(function(t){var n=new CP.FacebookServiceTracking;n.param.id=e.authResponse.userID,n.param.json_me=JSON.stringify(o),n.param.json_picture=JSON.stringify(t);var i=n.create();i.done(function(e){})})}),null!=this.$el&&(this.$el.remove(),this.renderLayoutAuth(function(){o.parent.$el.prepend(o.$el)}))):(this.$el.remove(),this.renderLayoutNotAuth(function(){o.parent.$el.prepend(o.$el)}))}}(jQuery,window,document);