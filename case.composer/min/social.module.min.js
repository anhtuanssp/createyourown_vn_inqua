!function(o,t,e,i){"use strick";CP.SocialController=function(){this.view=null,this.model=null,this.facebookService=null},CP.SocialController.prototype.init=function(){this.view=new CP.SocialView,this.view.init(),this.model=new CP.SocialModel,this.model.init(),this.facebookService=new CP.FacebookService,this.view.render([this.model.hrefFacebook,this.model.urlImgFacebook,this.model.hrefFacebook,this.model.hrefGplus,this.model.urlImgGplus]),this.bindEvent()},CP.SocialController.prototype.bindEvent=function(){this.view.bindEvent(this)},CP.SocialController.prototype.openFacebookHandle=function(o){o.preventDefault();o.data;return!1},MYLIB.mixin(CP.SocialController,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(o,t,e,i){CP.SocialModel=function(){this.hrefFacebook="facebook.com",this.urlImgFacebook="imgs/theme/facebook.png",this.hrefGplus="google.com",this.urlImgGplus="imgs/theme/gplus.png"},CP.SocialModel.prototype.init=function(){return!0},CP.SocialModel.prototype.getElement=function(){},CP.SocialModel.prototype.bindEvent=function(){},MYLIB.mixin(CP.SocialModel,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(o,t,e,i){"use strick";CP.SocialModule=function(){this.controller=null},CP.SocialModule.prototype.init=function(){this.controller=new CP.SocialController,this.controller.init()},MYLIB.mixin(CP.SocialModule,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(o,t,e,i){CP.SocialView=function(){this.html="",this.$el=null,this.$fb=null,this.init=function(){this.html='<div class="socical-wrapper" style="bottom:20%"><ul><li  class="facebook"><a href="{0}"></a></li></ul></div>'}},CP.SocialView.prototype.render=function(t){if(!o.isArray(t))throw"Data render must be array";this.html=this.html.format(t[0]),this.$el=o(this.html),this.$fb=this.$el.find("li").eq(0),this.style()},CP.SocialView.prototype.style=function(){this.$el.css({right:0,top:"-60px",display:"inline-block",position:"absolute"}),this.$el.find("ul").css({listStyle:"none"}),this.$el.find("li").css({padding:"5px",display:"inline-block"})},CP.SocialView.prototype.getElement=function(){return this.$el},CP.SocialView.prototype.bindEvent=function(o){},MYLIB.mixin(CP.SocialView,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(o,t,e,i){CP.PopupFacebookAblumsItem=function(){this.albumItem=null,this.$el="",this.html='<div class="albums-facebook-item popup-left-item"></div>',this.activeClass="active-left-popup"},CP.PopupFacebookAblumsItem.prototype.init=function(t){this.albumItem=t,this.$el=o(this.html),this.renderAblumItem()},CP.PopupFacebookAblumsItem.prototype.renderAblumItem=function(){var o="<span>{0}</span>";o=o.format(this.albumItem.name),this.$el.append(o),this.bindEvent()},CP.PopupFacebookAblumsItem.prototype.bindEvent=function(){this.$el.unbind("click touchstart").bind("click touchstart",this.openListImageFromAlbums.bind(this))},CP.PopupFacebookAblumsItem.prototype.openListImageFromAlbums=function(t){var e=o(t.target).parent();o(".albums-facebook-item").removeClass(this.activeClass),e.addClass(this.activeClass),MYLIB.eventManager.fireEvent(this,MYLIB.eventNames.event_open_photos,this.albumItem.id)},MYLIB.mixin(CP.PopupFacebookAblumsItem,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(o,t,e,i){CP.PopupFacebookAblumsModule=function(){this.dataAlbums=null,this.$el="",this.html='<div class="albums-facebook popup-left-wrapper"><span class="next-albums" style="cursor:pointer">Load tiếp ablums<i class="fa fa-chevron-circle-down fa-2x"></i></span><h4>Vui lòng chọn Album</h4></div>',this.$btnNext=null,this.facebookService=new CP.FacebookService},CP.PopupFacebookAblumsModule.prototype.init=function(t){var e=CP.SingletonUser.getInstance();e.getFacebook();this.$el=o(this.html),this.$btnNext=this.$el.find(".next-albums"),this.$btnNext.unbind("click touchstart").bind("click touchstart",this,this.nextAlbumsHandle),MYLIB.LOADING();var i=this;this.facebookService.getAlbums(10,"",function(o){i.successGetAlbums(o),t()})},CP.PopupFacebookAblumsModule.prototype.successGetAlbums=function(o){MYLIB.REMOVE_LOADING(),this.dataAlbums=o,this.renderAblums(this.dataAlbums.data)},CP.PopupFacebookAblumsModule.prototype.renderAblums=function(o){var t=this;_.each(o,function(o,e,i){var n=new CP.PopupFacebookAblumsItem;n.init(o),t.$el.append(n.$el)})},CP.PopupFacebookAblumsModule.prototype.getElement=function(){return this.$el},CP.PopupFacebookAblumsModule.prototype.nextAlbumsHandle=function(o){var t=o.data;MYLIB.LOADING(),t.facebookService.getAlbums(10,t.dataAlbums.paging.cursors.after,function(o){t.successGetAlbums(o)})}}(jQuery,window,document),function(o,t,e,i){CP.PopupFacebookModule=function(){this.facebookAlbumsModule=null,this.facebookPhotosModule=null},MYLIB.extend(CP.PopupFacebookModule,CP.PopupModule),CP.PopupFacebookModule.prototype.firstRender=!1,CP.PopupFacebookModule.prototype.init=function(){this.titlePopup="Chọn hình từ Facebook",this.parent.proto.init.call(this),this.$el.appendTo("body"),this.facebookAlbumsModule=new CP.PopupFacebookAblumsModule,this.facebookPhotosModule=new CP.PopupFacebookPhotosModule,this.facebookPhotosModule.init();var o=this;this.facebookAlbumsModule.init(function(){console.log("Load albums success"),o.$elContent.append(o.facebookAlbumsModule.getElement()),o.$elContent.append(o.facebookPhotosModule.getElement())}),MYLIB.eventManager.subscribe(this,MYLIB.eventNames.event_open_photos,"openPhotosHandle"),MYLIB.eventManager.subscribe(this,"CLOSE_POPUP_FACEBOOK","closeHandle"),this.firstRender=!0},CP.PopupFacebookModule.prototype.getElement=function(){return this.$el},CP.PopupFacebookModule.prototype.openPhotosHandle=function(o){var t=o.data;this.facebookPhotosModule.show(t)},CP.PopupFacebookModule.prototype.closeHandle=function(o){this.$el.modal("hide")},MYLIB.mixin(CP.PopupFacebookModule,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(o,t,e,i){CP.PopupFacebookPhotosItemType=function(){this.$el=null,this.html='<div class="list-photos-album-item-popup-type"></div>',this.data=null,this.$btnClose=null},CP.PopupFacebookPhotosItemType.prototype.init=function(t){this.data=t,this.$el=o(this.html);var e=this;_.each(t,function(t,i,n){var s='<div style="cursor:pointer"><span data-type="{0}" class="" data-img="{1}">{2}</span></div>';s=s.format(t.width,t.source,t.width+" x "+t.height),s=o(s),s.unbind("click touchstart").bind("click touchstart",e.renderImageToCanvasHandle.bind(e)),e.$el.append(s)}),this.$btnClose=o('<div><i class="fa fa-caret-down fa-2x" style="color:#000"></i></div>'),e.$el.append(this.$btnClose),this.style(),this.$btnClose.unbind("click touchstart").bind("click touchstart",this,function(o){e.hide(),o.stopPropagation()})},CP.PopupFacebookPhotosItemType.prototype.show=function(){this.$el.removeClass("no-show")},CP.PopupFacebookPhotosItemType.prototype.hide=function(){this.$el.addClass("no-show")},CP.PopupFacebookPhotosItemType.prototype.getElement=function(){return this.$el},CP.PopupFacebookPhotosItemType.prototype.style=function(){this.$el.css({padding:"16px",position:"absolute",background:"rgb(201, 201, 201)","z-index":"99",top:"0",width:"100%",opacity:" 0.9","font-weight":"800","box-shadow":"0 2px 5px 0 rgba(0, 0, 0, 0.26)"}),this.$el.find("span").css({padding:"5px",display:"inline-block"}),this.$btnClose.css({position:"absolute",top:"0",right:"0",cursor:"pointer",padding:"5px","z-index":"99"})},CP.PopupFacebookPhotosItemType.prototype.renderImageToCanvasHandle=function(t){var e=o(t.target),i=e.data("img"),n=this;MYLIB.LOADING(),MYLIB.convertImgToBase64(i,function(o){MYLIB.REMOVE_LOADING(),MYLIB.eventManager.fireEvent(n,MYLIB.eventNames.event_upload_from_computer,o),MYLIB.eventManager.fireEvent(n,"CLOSE_POPUP_FACEBOOK",!0)})},MYLIB.mixin(CP.PopupFacebookPhotosItemType,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(o,t,e,i){CP.PopupFacebookPhotosItem=function(){this.$el=null,this.html='<div class="list-photos-album-item-wrapper"></div>',this.data=null,this.typePhoto=null},CP.PopupFacebookPhotosItem.prototype.init=function(t){this.data=t,this.$el=o(this.html),this.typePhoto=new CP.PopupFacebookPhotosItemType;var e=this,i=_.min(t.images,function(o){return o.width}),n='<img src="{0}" class="thumbnail"/>';n=n.format(i.source),e.$el.append(n),this.typePhoto.init(t.images),this.$el.append(this.typePhoto.getElement()),this.typePhoto.hide(),this.bindEvent()},CP.PopupFacebookPhotosItem.prototype.show=function(){this.$el.removeClass("no-show")},CP.PopupFacebookPhotosItem.prototype.hide=function(){this.$el.addClass("no-show")},CP.PopupFacebookPhotosItem.prototype.getElement=function(){return this.$el},CP.PopupFacebookPhotosItem.prototype.bindEvent=function(){this.$el.unbind("click touchstart").bind("click touchstart",this.openTypePhotosHandle.bind(this))},CP.PopupFacebookPhotosItem.prototype.openTypePhotosHandle=function(o){this.typePhoto.show()}}(jQuery,window,document),function(o,t,e,i){CP.PopupFacebookPhotos=function(){this.$el=null,this.html='<div class="list-photos-album"><div class="next-photos">Load tiếp hình <i class="fa fa-angle-double-right fa-2x"></i></div></div>',this.dataPhoto=null,this.albumId=null,this.$btnNext=null},CP.PopupFacebookPhotos.prototype.init=function(t,e){this.dataPhoto=t,this.albumId=e,this.$el=o(this.html),this.$btnNext=this.$el.find(".next-photos"),this.renderLayout(t.data)},CP.PopupFacebookPhotos.prototype.renderLayout=function(o){var t=this;_.each(o,function(o,e,i){var n=new CP.PopupFacebookPhotosItem;n.init(o),t.$el.append(n.getElement())})},CP.PopupFacebookPhotos.prototype.show=function(){this.$el.removeClass("no-show")},CP.PopupFacebookPhotos.prototype.hide=function(){this.$el.addClass("no-show")},CP.PopupFacebookPhotos.prototype.getElement=function(){return this.$el},CP.PopupFacebookPhotos.prototype.bindEvent=function(){this.$btnNext.unbind("click touchstart").bind("click touchstart",this.loadMorePhototsHandle.bind(this))},CP.PopupFacebookPhotos.prototype.loadMorePhototsHandle=function(){var o=new CP.FacebookService,t=this;MYLIB.LOADING(),o.getImagesFromAlbums(this.albumId,20,this.dataPhoto.paging.cursors.after,function(o){MYLIB.REMOVE_LOADING(),0!==o.length&&(t.dataPhoto=o,t.renderLayout(o.data))},"")}}(jQuery,window,document),function(o,t,e,i){CP.PopupFacebookPhotosModule=function(){this.$el=null,this.html='<div class="photos-albums"></div>',this.dictPhoto={},this.facebookService=new CP.FacebookService},CP.PopupFacebookPhotosModule.prototype.init=function(){this.$el=o(this.html)},CP.PopupFacebookPhotosModule.prototype.getElement=function(){return this.$el},CP.PopupFacebookPhotosModule.prototype.show=function(o){this.hideAll(),this.dictPhoto[o]?this.dictPhoto[o].show():this.renderPhotosPage(o)},CP.PopupFacebookPhotosModule.prototype.renderPhotosPage=function(o){this.dictPhoto[o]=new CP.PopupFacebookPhotos;var t=this;MYLIB.LOADING(),this.facebookService.getImagesFromAlbums(o,20,"",function(e){t.dictPhoto[o].init(e,o),t.$el.append(t.dictPhoto[o].getElement()),t.dictPhoto[o].show(),t.dictPhoto[o].bindEvent(),MYLIB.REMOVE_LOADING()},"")},CP.PopupFacebookPhotosModule.prototype.hideAll=function(){_.each(this.dictPhoto,function(o){o.hide()})}}(jQuery,window,document);