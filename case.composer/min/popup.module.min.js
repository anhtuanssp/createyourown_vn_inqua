!function(t,e,s,i){CP.StickerModuleAssetDesign=function(e){this.tmp='<div class="col-sm-12 assetmedia-cates-wrapper"><div class="row"><ul class="row assetmedia-cates-list"></ul></div></div>',this.$el=null,this.ajaxData=CP.AssetsSerice.getInstance.getAssetsCates(),this.classActive="active",this.init=function(s){var i=this;this.ajaxData.done(function(o){var n=t(i.tmp);t.each(o.assets,function(s,i){var o=t('<li style="display:inline-block;margin:5px;cursor:pointer">'+i.asset_name+"</li>");o.click(function(s){e.filterByCate.call(e,i,t(this))}),n.find("ul").append(o)});var a=t('<li class="'+i.classActive+'" style="display:inline-block;margin:5px;cursor:pointer">Tất cả</li>');n.find("ul").append(a),a.click(function(s){e.filterByCate.call(e,{asset_id:"all"},t(this))}),i.$el=n,s()})}},CP.StickerModule=function(){return this.$el=null,this.$elMediaContent=null,this.$elBtnChonsanpham=null,this.$elTmpAS=null,this.viewPath=MYLIB.mainUrl+"js/module/popup.module/popup.module.asset.v2/view/template.html",this.limit=24,this.current_page=1,this.last_page=0,this.total=0,this.from=0,this.to=0,this.data=0,this.cateID="all",this.assetCateModule=new CP.StickerModuleAssetDesign(this),this.assetCateModule.init(this.renderAssetCate.bind(this)),this.listAssetMediaChoice=[],this.$prev=null,this.$next=null,this.tmpItem='<div class="as-item col-sm-2 col-xs-2" style="margin-bottom:20px;cursor:pointer;min-height:150px;max-height:150px"><img src="{0}" class="img-responsive img-thumbnail"/></div>',this},CP.StickerModule.prototype.renderAssetCate=function(){this.$el.find("#asc").append(this.assetCateModule.$el)},CP.StickerModule.prototype.filterByCate=function(t,e){this.current_page=1,this.assetCateModule.$el.find("li").removeClass(this.assetCateModule.classActive),e.addClass(this.assetCateModule.classActive),this.cateID=t.asset_id,this.callService(this.render.bind(this))},CP.StickerModule.prototype.loadTemplate=function(e){var s=this;t.get(this.viewPath,function(i){var o=t(i).html();s.$el=t(o),s.$elMediaContent=s.$el.find(".asset-media-content"),s.$prev=s.$el.find(".previous"),s.$next=s.$el.find(".next"),s.$elTmpAS=s.$el.find(".tmp-asset-media"),e()})},CP.StickerModule.prototype.init=function(t){var e=this;this.loadTemplate(function(){e.callService(e.render.bind(e)),t()})},CP.StickerModule.prototype.render=function(e){this.current_page=e.current_page,this.last_page=e.last_page,this.total=e.total,this.from=e.form,this.to=e.to,this.data=e.data;var s=this;this.renderPagination(),s.$elMediaContent.html(""),t.each(this.data,function(e,i){var o=t(s.tmpItem.format(MYLIB.IMAGEHOST+"/"+i.thumb));o.bind("click",i,function(t){s.choiceItem(t.data)}),s.$elMediaContent.append(o)})},CP.StickerModule.prototype.choiceItem=function(t){var e=this;MYLIB.LOADING();var s=MYLIB.IMAGEHOST+t.photo,i=t.id,o=t.thumb;CP.AssetsSerice.getInstance.addCountAssetMedia(i),MYLIB.convertImgToBase64(s,function(t){MYLIB.REMOVE_LOADING(),MYLIB.eventManager.fireEvent(e,MYLIB.eventNames.event_upload_from_asset,{src:t,id:i,thumb:o}),MYLIB.eventManager.fireEvent(e,"CLOSE_POPUP_ASSET",!0)})},CP.StickerModule.prototype.renderPagination=function(){this.current_page>1&&this.current_page<this.last_page?(this.$prev.removeClass("disable").css({opacity:"1",cursor:"pointer"}),this.$next.removeClass("disable").css({opacity:"1",cursor:"pointer"}),this.$prev.unbind("click").bind("click",this.prevAction.bind(this)),this.$next.unbind("click").bind("click",this.nextAction.bind(this))):1==this.current_page&&1==this.last_page?(this.$prev.addClass("disable").css({opacity:"0.5",cursor:"default"}),this.$next.removeClass("disable").css({opacity:"0.5",cursor:"default"}),this.$prev.unbind("click"),this.$next.unbind("click")):this.current_page==this.last_page?(this.$prev.removeClass("disable").css({opacity:"1",cursor:"pointer"}),this.$next.addClass("disable").css({opacity:"0.5",cursor:"default"}),this.$prev.unbind("click").bind("click",this.prevAction.bind(this)),this.$next.unbind("click")):1==this.current_page&&(this.$prev.addClass("disable").css({opacity:"0.5",cursor:"default"}),this.$next.removeClass("disable").css({opacity:"1",cursor:"pointer"}),this.$prev.unbind("click"),this.$next.unbind("click").bind("click",this.nextAction.bind(this)))},CP.StickerModule.prototype.prevAction=function(){this.current_page--,this.callService(this.render.bind(this))},CP.StickerModule.prototype.nextAction=function(){this.current_page++,this.callService(this.render.bind(this))},CP.StickerModule.prototype.callService=function(t){var e=CP.AssetsSerice.getInstance.getAssetMediaByLimit(this.limit,this.current_page,this.cateID);return MYLIB.LOADING_WITH_EL(this.$elMediaContent),e.done(function(e){t(e),MYLIB.REMOVE_LOADING()}),this}}(jQuery,window,document),function(t,e,s,i){CP.PopupAssetCategoryItem=function(){this.cateItem=null,this.$el="",this.html='<div class="popup-left-item"></div>',this.activeClass="active-left-popup"},CP.PopupAssetCategoryItem.prototype.init=function(e){this.cateItem=e,this.$el=t(this.html),this.renderAblumItem()},CP.PopupAssetCategoryItem.prototype.renderAblumItem=function(){var t="<span>{0}</span>";t=t.format(this.cateItem.asset_name),this.$el.append(t),this.bindEvent()},CP.PopupAssetCategoryItem.prototype.bindEvent=function(){this.$el.unbind("click touchstart").bind("click touchstart",this.openListImageFromAssets.bind(this))},CP.PopupAssetCategoryItem.prototype.openListImageFromAssets=function(e){var s=t(e.target).parent();this.$el.siblings().removeClass(this.activeClass),s.addClass(this.activeClass),MYLIB.eventManager.fireEvent(this,MYLIB.eventNames.event_open_asset_photos,this.cateItem.asset_id)},MYLIB.mixin(CP.PopupAssetCategoryItem,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(t,e,s,i){CP.PopupAssetCategories=function(){this.dataCates=null,this.$el="",this.html='<div class="popup-left-wrapper"><h4>Vui lòng chọn thư viện</h4></div>',this.$btnNext=null,this.service=new CP.AssetsSerice},CP.PopupAssetCategories.prototype.init=function(e){var s=CP.SingletonUser.getInstance();s.getFacebook();this.$el=t(this.html),MYLIB.LOADING();var i=this,o=this.service.getAssetsCates();o.done(function(t){i.successGetCates.call(i,t),e.call(i),MYLIB.REMOVE_LOADING()})},CP.PopupAssetCategories.prototype.successGetCates=function(t){MYLIB.REMOVE_LOADING(),this.dataCates=t,this.render(this.dataCates)},CP.PopupAssetCategories.prototype.render=function(t){var e=this;_.each(t.assets,function(t,s,i){var o=new CP.PopupAssetCategoryItem;o.init(t),e.$el.append(o.$el)})},CP.PopupAssetCategories.prototype.getElement=function(){return this.$el}}(jQuery,window,document),function(t,e,s,i){CP.PopupAssetsModule=function(){this.popupAssetV2=null},MYLIB.extend(CP.PopupAssetsModule,CP.PopupModule),CP.PopupAssetsModule.prototype.firstRender=!1,CP.PopupAssetsModule.prototype.init=function(){this.titlePopup="Chọn hình từ thư viện",this.parent.proto.init.call(this),this.$el.appendTo("body"),this.popupAssetV2=new CP.StickerModule;var t=this;this.popupAssetV2.init(function(){t.$el.find(".modal-content").append(t.popupAssetV2.$el)}),MYLIB.eventManager.subscribe(this,MYLIB.eventNames.event_open_asset_photos,"openPhotosHandle"),MYLIB.eventManager.subscribe(this,"CLOSE_POPUP_ASSET","closeHandle"),this.firstRender=!0},CP.PopupAssetsModule.prototype.getElement=function(){return this.$el},CP.PopupAssetsModule.prototype.render=function(){},CP.PopupAssetsModule.prototype.openPhotosHandle=function(t){t.data},CP.PopupAssetsModule.prototype.closeHandle=function(t){this.$el.modal("hide")},MYLIB.mixin(CP.PopupAssetsModule,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(t,e,s,i){CP.PopupAssetsModulePhotosArea=function(){this.$el=null,this.html='<div class="photos-albums"></div>',this.dictPhoto={},this.service=new CP.AssetsSerice},CP.PopupAssetsModulePhotosArea.prototype.init=function(){this.$el=t(this.html)},CP.PopupAssetsModulePhotosArea.prototype.getElement=function(){return this.$el},CP.PopupAssetsModulePhotosArea.prototype.show=function(t){this.hideAll(),this.dictPhoto[t]?this.dictPhoto[t].show():this.renderPhotosPage(t)},CP.PopupAssetsModulePhotosArea.prototype.renderPhotosPage=function(t){this.dictPhoto[t]=new CP.PopupAssetsModulePhotos;var e=this;MYLIB.LOADING();var s=this.service.getAssetsMediaByCates(t);s.done(function(s){e.dictPhoto[t].init(s,t),e.$el.append(e.dictPhoto[t].getElement()),e.dictPhoto[t].show(),e.dictPhoto[t].bindEvent(),MYLIB.REMOVE_LOADING()}),s.error(function(){MYLIB.REMOVE_LOADING(),alert("Something wrong, vui lòng thử lại")})},CP.PopupAssetsModulePhotosArea.prototype.hideAll=function(){_.each(this.dictPhoto,function(t){t.hide()})}}(jQuery,window,document),function(t,e,s,i){CP.PopupAssetsModulePhotosItem=function(){this.$el=null,this.html='<div class="list-photos-album-item-wrapper"></div>',this.data=null,this.typePhoto=null},CP.PopupAssetsModulePhotosItem.prototype.init=function(e){this.data=e,this.$el=t(this.html);var s='<img src="{0}" class="thumbnail"/>';s=s.format(MYLIB.IMAGEHOST+"/"+e.thumb),this.$el.append(s),this.bindEvent()},CP.PopupAssetsModulePhotosItem.prototype.show=function(){this.$el.removeClass("no-show")},CP.PopupAssetsModulePhotosItem.prototype.hide=function(){this.$el.addClass("no-show")},CP.PopupAssetsModulePhotosItem.prototype.getElement=function(){return this.$el},CP.PopupAssetsModulePhotosItem.prototype.bindEvent=function(){var t=this;this.$el.unbind("click touch").bind("click touch",function(e){MYLIB.LOADING();var s=MYLIB.IMAGEHOST+t.data.photo,i=t.data.id,o=t.data.thumb;CP.AssetsSerice.getInstance.addCountAssetMedia(i),MYLIB.convertImgToBase64(s,function(e){MYLIB.REMOVE_LOADING(),MYLIB.eventManager.fireEvent(t,MYLIB.eventNames.event_upload_from_asset,{src:e,id:i,thumb:o}),MYLIB.eventManager.fireEvent(t,"CLOSE_POPUP_ASSET",!0)})})}}(jQuery,window,document),function(t,e,s,i){CP.PopupAssetsModulePhotos=function(){this.$el=null,this.html='<div  class="list-photos-album"></div>',this.dataPhoto=null,this.albumId=null},CP.PopupAssetsModulePhotos.prototype.init=function(e,s){this.dataPhoto=e,this.albumId=s,this.$el=t(this.html),this.renderLayout(e)},CP.PopupAssetsModulePhotos.prototype.renderLayout=function(t){var e=this;t.reverse(),_.each(t,function(t,s,i){var o=new CP.PopupAssetsModulePhotosItem;o.init(t),e.$el.append(o.getElement())})},CP.PopupAssetsModulePhotos.prototype.show=function(){this.$el.removeClass("no-show")},CP.PopupAssetsModulePhotos.prototype.hide=function(){this.$el.addClass("no-show")},CP.PopupAssetsModulePhotos.prototype.getElement=function(){return this.$el},CP.PopupAssetsModulePhotos.prototype.bindEvent=function(){}}(jQuery,window,document);