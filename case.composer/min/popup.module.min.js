!function(t,e,s,o){CP.PopupAssetCategoryItem=function(){this.cateItem=null,this.$el="",this.html='<div class="popup-left-item"></div>',this.activeClass="active-left-popup"},CP.PopupAssetCategoryItem.prototype.init=function(e){this.cateItem=e,this.$el=t(this.html),this.renderAblumItem()},CP.PopupAssetCategoryItem.prototype.renderAblumItem=function(){var t="<span>{0}</span>";t=t.format(this.cateItem.asset_name),this.$el.append(t),this.bindEvent()},CP.PopupAssetCategoryItem.prototype.bindEvent=function(){this.$el.unbind("click touchstart").bind("click touchstart",this.openListImageFromAssets.bind(this))},CP.PopupAssetCategoryItem.prototype.openListImageFromAssets=function(e){var s=t(e.target).parent();this.$el.siblings().removeClass(this.activeClass),s.addClass(this.activeClass),MYLIB.eventManager.fireEvent(this,MYLIB.eventNames.event_open_asset_photos,this.cateItem.asset_id)},MYLIB.mixin(CP.PopupAssetCategoryItem,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(t,e,s,o){CP.PopupAssetCategories=function(){this.dataCates=null,this.$el="",this.html='<div class="popup-left-wrapper"><h4>Vui lòng chọn thư viện</h4></div>',this.$btnNext=null,this.service=new CP.AssetsSerice},CP.PopupAssetCategories.prototype.init=function(e){var s=CP.SingletonUser.getInstance();s.getFacebook();this.$el=t(this.html),MYLIB.LOADING();var o=this,i=this.service.getAssetsCates();i.done(function(t){o.successGetCates.call(o,t),e.call(o),MYLIB.REMOVE_LOADING()})},CP.PopupAssetCategories.prototype.successGetCates=function(t){MYLIB.REMOVE_LOADING(),this.dataCates=t,this.render(this.dataCates)},CP.PopupAssetCategories.prototype.render=function(t){var e=this;_.each(t.assets,function(t,s,o){var i=new CP.PopupAssetCategoryItem;i.init(t),e.$el.append(i.$el)})},CP.PopupAssetCategories.prototype.getElement=function(){return this.$el}}(jQuery,window,document),function(t,e,s,o){CP.PopupAssetsModule=function(){this.popupAssetsCates=null,this.popupAssetsAssetArea=null},MYLIB.extend(CP.PopupAssetsModule,CP.PopupModule),CP.PopupAssetsModule.prototype.firstRender=!1,CP.PopupAssetsModule.prototype.init=function(){this.titlePopup="Chọn hình từ thư viện",this.parent.proto.init.call(this),this.$el.appendTo("body"),this.popupAssetsAssetArea=new CP.PopupAssetsModulePhotosArea,this.popupAssetsAssetArea.init(),this.popupAssetsCates=new CP.PopupAssetCategories,this.popupAssetsCates.init(this.render.bind(this)),MYLIB.eventManager.subscribe(this,MYLIB.eventNames.event_open_asset_photos,"openPhotosHandle"),MYLIB.eventManager.subscribe(this,"CLOSE_POPUP_ASSET","closeHandle"),this.firstRender=!0},CP.PopupAssetsModule.prototype.getElement=function(){return this.$el},CP.PopupAssetsModule.prototype.render=function(){this.$elContent.append(this.popupAssetsCates.getElement()),this.$elContent.append(this.popupAssetsAssetArea.getElement())},CP.PopupAssetsModule.prototype.openPhotosHandle=function(t){var e=t.data;this.popupAssetsAssetArea.show(e)},CP.PopupAssetsModule.prototype.closeHandle=function(t){this.$el.modal("hide")},MYLIB.mixin(CP.PopupAssetsModule,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(t,e,s,o){CP.PopupAssetsModulePhotosArea=function(){this.$el=null,this.html='<div class="photos-albums"></div>',this.dictPhoto={},this.service=new CP.AssetsSerice},CP.PopupAssetsModulePhotosArea.prototype.init=function(){this.$el=t(this.html)},CP.PopupAssetsModulePhotosArea.prototype.getElement=function(){return this.$el},CP.PopupAssetsModulePhotosArea.prototype.show=function(t){this.hideAll(),this.dictPhoto[t]?this.dictPhoto[t].show():this.renderPhotosPage(t)},CP.PopupAssetsModulePhotosArea.prototype.renderPhotosPage=function(t){this.dictPhoto[t]=new CP.PopupAssetsModulePhotos;var e=this;MYLIB.LOADING();var s=this.service.getAssetsMediaByCates(t);s.done(function(s){e.dictPhoto[t].init(s,t),e.$el.append(e.dictPhoto[t].getElement()),e.dictPhoto[t].show(),e.dictPhoto[t].bindEvent(),MYLIB.REMOVE_LOADING()}),s.error(function(){MYLIB.REMOVE_LOADING(),alert("Something wrong, vui lòng thử lại")})},CP.PopupAssetsModulePhotosArea.prototype.hideAll=function(){_.each(this.dictPhoto,function(t){t.hide()})}}(jQuery,window,document),function(t,e,s,o){CP.PopupAssetsModulePhotosItem=function(){this.$el=null,this.html='<div class="list-photos-album-item-wrapper"></div>',this.data=null,this.typePhoto=null},CP.PopupAssetsModulePhotosItem.prototype.init=function(e){this.data=e,this.$el=t(this.html);var s='<img src="{0}" class="thumbnail"/>';s=s.format(MYLIB.IMAGEHOST+"/"+e.thumb),this.$el.append(s),this.bindEvent()},CP.PopupAssetsModulePhotosItem.prototype.show=function(){this.$el.removeClass("no-show")},CP.PopupAssetsModulePhotosItem.prototype.hide=function(){this.$el.addClass("no-show")},CP.PopupAssetsModulePhotosItem.prototype.getElement=function(){return this.$el},CP.PopupAssetsModulePhotosItem.prototype.bindEvent=function(){var t=this;this.$el.unbind("click touch").bind("click touch",function(e){MYLIB.LOADING();var s=MYLIB.IMAGEHOST+t.data.photo,o=t.data.id,i=t.data.thumb;CP.AssetsSerice.getInstance.addCountAssetMedia(o),MYLIB.convertImgToBase64(s,function(e){MYLIB.REMOVE_LOADING(),MYLIB.eventManager.fireEvent(t,MYLIB.eventNames.event_upload_from_asset,{src:e,id:o,thumb:i}),MYLIB.eventManager.fireEvent(t,"CLOSE_POPUP_ASSET",!0)})})}}(jQuery,window,document),function(t,e,s,o){CP.PopupAssetsModulePhotos=function(){this.$el=null,this.html='<div  class="list-photos-album"></div>',this.dataPhoto=null,this.albumId=null},CP.PopupAssetsModulePhotos.prototype.init=function(e,s){this.dataPhoto=e,this.albumId=s,this.$el=t(this.html),this.renderLayout(e)},CP.PopupAssetsModulePhotos.prototype.renderLayout=function(t){var e=this;t.reverse(),_.each(t,function(t,s,o){var i=new CP.PopupAssetsModulePhotosItem;i.init(t),e.$el.append(i.getElement())})},CP.PopupAssetsModulePhotos.prototype.show=function(){this.$el.removeClass("no-show")},CP.PopupAssetsModulePhotos.prototype.hide=function(){this.$el.addClass("no-show")},CP.PopupAssetsModulePhotos.prototype.getElement=function(){return this.$el},CP.PopupAssetsModulePhotos.prototype.bindEvent=function(){}}(jQuery,window,document);