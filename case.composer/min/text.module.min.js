!function(t,e,n,o){CP.TextModuleCustom=function(){},CP.TextModuleCustom.prototype.html='<div id="text-module-custom" class="panel panel-default"><div class="panel-heading"><span>Chọn font chữ</span></div><div class="slide-font-size panel-body"><input id="{0}" type="range" min="0" max="50" value="{1}" step="1"  /><output id="{2}"></output></div></div>',CP.TextModuleCustom.prototype.$el=null,CP.TextModuleCustom.prototype.$rangeFontSzie=null,CP.TextModuleCustom.prototype.$outputRangeFontSzie=null,CP.TextModuleCustom.prototype.init=function(){this.html=this.html.format(MYLIB.constant.text_module_custom_font_size_id,CP_INIT.text.fontSize,MYLIB.constant.text_module_custom_font_size_output_id),this.$el=t(this.html),this.$rangeFontSzie=this.$el.find("#"+MYLIB.constant.text_module_custom_font_size_id),this.$outputRangeFontSzie=this.$el.find("#"+MYLIB.constant.text_module_custom_font_size_output_id);var e=this.$rangeFontSzie.val();this.$outputRangeFontSzie.html(e+"px"),this.style(),this.bindEvent()},CP.TextModuleCustom.prototype.style=function(){this.$el.css({border:"1px solid rgb(217, 237, 204)",margin:"10px 0px 0px 0px"}),this.$outputRangeFontSzie.css({margin:"0 auto","text-align":"center"})},CP.TextModuleCustom.prototype.getElement=function(){return this.$el},CP.TextModuleCustom.prototype.bindEvent=function(){this.$rangeFontSzie.unbind("change").bind("change",this,this.changeRangeFontSizeHandle)},CP.TextModuleCustom.prototype.changeRangeFontSizeHandle=function(t){var e=t.data,n=e.$rangeFontSzie.val();e.$outputRangeFontSzie.html(n+"px"),MYLIB.eventManager.fireEvent(e,MYLIB.eventNames.event_fontSize,n)},MYLIB.mixin(CP.TextModuleCustom,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(t,e,n,o){CP.TextFormModule=function(){},CP.TextFormModule.prototype.html='<div class="panel-body" id="text-form-module"><input type="text" id="form-text" class="input" placeholder="Your sologan :D" /><button id="submit-form-text" class="btn btn-default" style="position:absolute"><span class="glyphicon glyphicon-plus"></span></button><br><br><button type="button" class="btn btn-default btn-open-cloud-text" style="width:100%;position:relative;padding:10px;color:#ff57ff;border-color:#ff57ff"><i class="ion-ios-flower-outline" aria-hidden="true"style="position:absolute;left:5px;top:0px;color:#ff57ff;font-size:30px"></i>Cloud text</button></div>',CP.TextFormModule.prototype.$el=null,CP.TextFormModule.prototype.$btnSubmit=null,CP.TextFormModule.prototype.$inputText=null,CP.TextFormModule.prototype.init=function(){this.$el=t(this.html),this.$btnSubmit=this.$el.find("#submit-form-text"),this.$inputText=this.$el.find("#form-text"),this.bindEvent()},CP.TextFormModule.prototype.getElement=function(){return this.$el},CP.TextFormModule.prototype.bindEvent=function(){var t=this;this.$btnSubmit.unbind("click touchstart").bind("click touchstart",this.submitHandle.bind(this)),this.$inputText.keypress(function(e){13==e.which&&t.submitHandle()}),this.$el.find(".btn-open-cloud-text").bind("click touchstart",function(){MYLIB.eventManager.fireEvent(t,MYLIB.eventNames.event_open_font_edit,!1)})},CP.TextFormModule.prototype.submitHandle=function(){var t=this.$inputText.val();""!=t?MYLIB.eventManager.fireEvent(this,MYLIB.eventNames.event_submit_text,t):alert("PLEASE ENTER YOUR CUSTOM TEXT")},MYLIB.mixin(CP.TextFormModule,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(t,e,n,o){CP.TextModule=function(){},CP.TextModule.prototype.html='<div data-step="5" data-intro="Đánh chữ vào ô và bấm nút + để thêm chữ vào sản phẩm" class="panel" id="text-module"><div class="panel-heading"><i class="ion-ios-compose size-18"></i> Nhập text vào sản phẩm</div></div>',CP.TextModule.prototype.$el=null,CP.TextModule.prototype.formText=null,CP.TextModule.prototype.init=function(){this.$el=t(this.html),this.renderLayout()},CP.TextModule.prototype.renderLayout=function(){this.formText=new CP.TextFormModule,this.formText.init(),this.$el.append(this.formText.getElement())},CP.TextModule.prototype.getElement=function(){return this.$el},MYLIB.mixin(CP.TextModule,MYLIB.Event.ObserverMixin)}(jQuery,window,document),function(t,e,n,o,i){CP.EditFontModule=function(e){if(this.viewPath="js/module/text.module/popup.edit.font/view/template.html",this.callbackDashboard=e,t==i)throw"Require D3js";this.fill=null,this.layout=null,this.words=null;var n=this;this.drawClouldText=function(e,o){n.$el.find(".d3-cloud-text-demo").html(""),n.words=e,t.select(n.$el.find(".d3-cloud-text-demo")[0]).append("svg").attr("width",n.layout.size()[0]).attr("height",n.layout.size()[1]).append("g").attr("transform","translate("+n.layout.size()[0]/2+","+n.layout.size()[1]/2+")").selectAll("text").data(e).enter().append("text").style("font-size",function(t){return t.size+"px"}).style("font-family",o).style("fill",function(t,e){return t.fillColor}).attr("text-anchor","middle").attr("transform",function(t){return"translate("+[t.x,t.y]+")rotate("+t.rotate+")"}).text(function(t){return t.text})},this.setLayoutD3Clould=function(e,o){e==i&&(e=["Nhập","ký tự","mà","bạn","mong","muốn","words","vào","ô","ở","dưới"]),o==i&&(o="arial"),this.layout=t.layout.cloud().size([500,300]).words(e.map(function(t){return{text:t,size:10+90*Math.random(),fillColor:n.fill(t)}})).padding(5).rotate(function(){return 90*~~(2*Math.random())}).font(o).fontSize(function(t){return t.size}).on("end",function(t){n.drawClouldText(t,o)}),this.layout.start()}},MYLIB.extend(CP.EditFontModule,CP.PopupModule),CP.EditFontModule.prototype.$elSelect=null,CP.EditFontModule.prototype.$spanThuNghiem=null,CP.EditFontModule.prototype.customTextControl=null,CP.EditFontModule.prototype.$inputUploadPartern=null,CP.EditFontModule.prototype.$elSelectV2=null,CP.EditFontModule.prototype.$elInputFontWeight=null,CP.EditFontModule.prototype.init=function(){this.titlePopup="Chỉnh sửa font chử",this.parent.proto.init.call(this),this.$el.find(".modal-dialog").removeClass("modal-lg"),this.$el.appendTo("body"),this.render()},CP.EditFontModule.prototype.getElement=function(){return this.$el},CP.EditFontModule.prototype.render=function(){var n=this;e.get(this.viewPath,function(o){var i=e(o).html(),l=Handlebars.compile(i),a=l();n.$elContent.append(e(a)),n.initElement.call(n),n.bindEvent(),n.fill=t.scale.category20(),n.setLayoutD3Clould()})},CP.EditFontModule.prototype.initElement=function(){this.$elSelect=this.$elContent.find(".font-select"),this.$spanThuNghiem=this.$elContent.find(".thunghiem"),this.$elSelectV2=this.$elContent.find(".font-select-v2"),this.$inputUploadPartern=this.$el.find('input[name="imagePatternFormComputer"]'),this.$elInputFontWeight=this.$el.find('input[name="fontW"]'),this.$elSelect.css({width:"100%",height:"50px","font-size":"30px"}),this.renderFontSelect(CP_INIT.text.listFont)},CP.EditFontModule.prototype.renderFontSelect=function(t){var n=this;_.each(t,function(t,o,i){var l='<option value="{0}">{1}</option>';l=l.format(t.font,t.label),l=e(l),n.$elSelect.append(l);var a='<label style="padding:5px"><input type="radio" name="fontvalue" value="{0}"> <span style="font-family: {1};font-size:20px">SAMPLE</span> </label>';a=a.format(t.label,t.font),a=e(a),e(a).find("input").unbind("click").bind("click",n.changeFontHandlerV2.bind(n)),n.$elSelectV2.append(a)})},CP.EditFontModule.prototype.bindEvent=function(){var t=this.$elSelect.val(),e=this;this.$spanThuNghiem.css({"font-family":t}),this.$elSelect.change(this.changeFontHandler.bind(this)),this.$inputUploadPartern.unbind("change").bind("change",this,this.imageFileFromComputerHandle),this.$el.find('input[name="check-curve-text"]').unbind("change").bind("change",this,this.changeCurveTextHandle),this.$elInputFontWeight.unbind("change").bind("change",this.changeFontWeightHandle.bind(this)),this.$el.find('textarea[name="clould-world"]').bind("change",function(t){}),this.$el.find("button.btn-cloud-text-submit").click(function(t){var n=o.createElement("canvas"),i=n.getContext("2d");n.width=500,n.height=300,i.translate(250,150),e.words.forEach(function(t){i.save(),i.translate(t.x,t.y),i.rotate(t.rotate*Math.PI/180),i.textAlign="center",i.fillStyle=e.fill(t.text.toLowerCase()),i.font=t.size+"px "+t.font,i.fillText(t.text,0,0),i.restore()}),MYLIB.eventManager.fireEvent(e,MYLIB.eventNames.event_upload_from_computer,n.toDataURL("image/png")),e.hide()}),this.$el.find("button.xem-truoc").click(function(t){var n=e.$el.find("input[name=fontvalue]:checked").val();e.setLayoutD3Clould(e.$el.find('textarea[name="clould-world"]').val().split(" "),n)})},CP.EditFontModule.prototype.imageFileFromComputerHandle=function(t){var e=t.data,n=new FileReader;n.onload=function(t){MYLIB.eventManager.fireEvent(e,MYLIB.eventNames.event_change_partern,t.target.result)},n.readAsDataURL(t.target.files[0])},CP.EditFontModule.prototype.changeFontHandler=function(){var t=this.$elSelect.val();console.log(t),this.$spanThuNghiem.css({"font-family":t}),MYLIB.eventManager.fireEvent(this,MYLIB.eventNames.event_change_font,t)},CP.EditFontModule.prototype.changeFontHandlerV2=function(t){var n=e(t.target).val();this.$spanThuNghiem.css({"font-family":n}),MYLIB.eventManager.fireEvent(this,MYLIB.eventNames.event_change_font,n)},CP.EditFontModule.prototype.changeCurveTextHandle=function(){MYLIB.eventManager.fireEvent(this,"CURVER_TEXT",!0)},CP.EditFontModule.prototype.changeFontWeightHandle=function(t){var n=e(t.target).val();this.$spanThuNghiem.css({"font-weight":n}),MYLIB.eventManager.fireEvent(this,"CHANGEFONTWEIGHT",n)},CP.EditFontModule.prototype.show=function(t){t!=i&&1==t?(this.$el.find(".toggle-zone-font").hide(),this.$el.modal("show"),this.$el.find(".d3-cloud-world").show(),this.$el.find(".modal-backdrop").height(e(n).height()+700)):(this.$el.find(".toggle-zone-font").show(),this.$el.modal("show"),this.$el.find(".d3-cloud-world").hide(),this.$el.find(".modal-backdrop").height(e(n).height()+700)),this.$elSelectV2.find('input[name="fontvalue"]').prop("checked",!1)},MYLIB.mixin(CP.PopupAssetsModule,MYLIB.Event.ObserverMixin)}(d3,jQuery,window,document);